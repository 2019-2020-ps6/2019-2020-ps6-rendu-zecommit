<app-navbar title="Création d'un quiz" [trouble]="trouble" [path]="questId?'../..':'..'"></app-navbar>

<form [formGroup]="questionForm" *ngIf="quizId">
    <div class="form-group has-error">
        <label for="text">
        Texte <br>
        <input class="input-custom" type="text" id="name" [formControlName]="'text'">
        </label>
        <label for="image">
          Image <br>
          <app-image-uploader (cardImageBase64Event)="receiveImg($event)" [imageLoad]="imageQuestion"></app-image-uploader>
        </label>
        <p *ngIf="invalidQuestion()" id="text" class="help-block">champ vide *.</p>

    </div>
    <form [formGroup]="questionType">
      <div class="control">
        <label for="texte">Texte

        <input type="radio" id="text" [formControlName]="'type'" [formTarget] value="text">
      </label>
      <label for="image">Image

        <input type="radio" id="image" [formControlName]="'type'" value="image">
      </label>
      </div>
    </form>
    <div formArrayName="answers" *ngFor="let elm of formData.controls; let i = index" >
        <div class="form-group has-error" [formGroupName]="i">
            <label for="titre">
                Réponse {{ i+1 }} <br/>
                <input *ngIf="questionType.value.type=='text'" type="text" id="text" [formControlName]="'text'">

                <app-image-uploader *ngIf="questionType.value.type=='image'" (cardImageBase64Event)="receiveImgAnsw($event,i)" [imageLoad]="elm.value.image"></app-image-uploader>

            </label>
            <label for="isCorrect">
                <input type="checkbox" id="isCorrect" [formControlName]="'isCorrect'">
                Réponse vraie
            </label>
            <p *ngIf="questionType.value.type=='text'&&invalidAnswer(i)" id="text" class="help-block">champ vide *.</p>
            <p *ngIf="questionType.value.type=='image'&&invalidImage(i)" id="image" class="help-block">image vide *.</p>

        </div>
    </div>
    <button *ngIf="questionType.value.type=='image'" [class]="!(questionForm.valid&&controlRightAnswer()&&controlImage())? 'btn btn-danger':'btn btn-success'" [disabled]="!(questionForm.valid&&controlRightAnswer()&&controlImage())" (click)="question? changeQuestion():addQuestion();">Valider</button>
    <button *ngIf="questionType.value.type=='text'" [class]="!(questionForm.valid&&controlRightAnswer()&&controlText())? 'btn btn-danger':'btn btn-success'" [disabled]="!(questionForm.valid&&controlRightAnswer()&&controlText())" (click)="question? changeQuestion():addQuestion();">Valider</button>
</form>
<p *ngIf="!controlRightAnswer()" id="text" class="help-block">Cocher au moins une bonne réponse</p>
